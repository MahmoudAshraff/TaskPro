<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Advanced Task Manager - Organize your tasks with style and efficiency">
    <meta name="theme-color" content="#6366f1">
    <title>Task Manager Pro</title>
    
    <!-- CSS (production single file) -->
    <link rel="stylesheet" href="css/styles.prod.min.css">
    <style>
    /* Sidebar responsive / toggle overrides */
    .sidebar {
        position: relative;
        transform: translateX(0);
        transition: transform 220ms ease, box-shadow 220ms ease;
        z-index: 50;
    }

    /* Hidden state for small screens */
    .sidebar[aria-hidden="true"] {
        transform: translateX(-104%);
        box-shadow: none;
    }

    .sidebar.open {
        transform: translateX(0);
        box-shadow: 0 6px 24px rgba(16,24,40,0.12);
    }

    .sidebar-overlay {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.35);
        z-index: 40;
        opacity: 0;
        transition: opacity 180ms ease;
    }

    .sidebar-overlay.active { display:block; opacity:1; }

    /* Header filter badge */
    .filter-badge {
        display: inline-block;
        min-width: 18px;
        height: 18px;
        line-height: 18px;
        font-size: 11px;
        text-align: center;
        border-radius: 999px;
        background: #ef4444;
        color: #fff;
        margin-left: 6px;
        padding: 0 6px;
    }

    @media (min-width: 880px) {
        .sidebar { transform: translateX(0) !important; }
        .sidebar-overlay { display:none !important; }
    }
    
    /* Smooth scroll and task fade-in */
    html { scroll-behavior: smooth; overflow-x: hidden; width: 100%; }
    body { overflow-y: auto; overflow-x: hidden; width: 100%; margin: 0; padding: 0; }
    * { box-sizing: border-box; }

    .main-container { max-height: calc(100vh - 80px); overflow-y: auto; width: 100%; max-width: 100vw; overflow-x: hidden; }
    .content { overflow-y: auto; max-height: 100%; overflow-x: hidden; }
    .tasks-section { max-height: auto; overflow-y: visible; margin-bottom: 12px; }
    /* Keep charts and stats static (not scrollable) */
    .stats-section { max-height: none; overflow: visible; }

    /* Header / buttons styling: uniform size, remove emoji reliance */
    .header .header-right { display:flex; align-items:center; gap:8px; }
    .header .header-right .btn-icon,
    .header .header-right .btn-secondary,
    .header .header-right .btn-primary { height:40px; padding:0 12px; display:inline-flex; align-items:center; justify-content:center; gap:8px; font-size:14px; }
    .header .header-right .btn-icon .icon { display:none; }

    /* Sign in / register: borderless pair with thin divider */
    .auth-pair { display:inline-flex; align-items:center; border-left: none; }
    .auth-pair .btn-icon { border: none; background: transparent; }
    .auth-pair .btn-secondary { border-left: 1px solid rgba(0,0,0,0.08); margin-left:0; padding-left:12px; }

    /* Logo styling: larger, styled text, remove check */
    .logo { display:flex; align-items:center; gap:10px; font-size:24px; margin:0; }
    .logo-text { font-weight:700; background: linear-gradient(90deg,#6366f1,#06b6d4); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }

    /* Footer styling */
    .app-footer { background: var(--bg-secondary); border-top: 1px solid var(--border-color); padding: 16px 20px; text-align: center; font-size: 13px; color: var(--text-tertiary); margin-top: 24px; }
    .app-footer p { margin: 0; }

    </style>
</head>
<body>
    <!-- Header -->
    <header class="header" role="banner">
        <div class="header-container">
            <div class="header-left">
                <h1 class="logo">
                    <span class="logo-text">TaskPro</span>
                </h1>
            </div>
            
            <div class="header-center">
                <div class="search-box">
                    <input 
                        type="text" 
                        id="searchInput" 
                        class="search-input" 
                        placeholder="Search tasks..."
                        aria-label="Search tasks"
                    >
                    <span class="search-icon"></span>
                </div>
            </div>
            
            <div class="header-right">
                <button class="btn-icon" id="filtersToggle" aria-label="Open filters" title="Filters">
                    <span class="btn-text">Filters</span>
                    <span class="filter-badge" id="filterBadge" style="display:none;">0</span>
                </button>

                <button 
                    class="btn-icon" 
                    id="dragToggle" 
                    title="Toggle drag-to-reorder"
                    aria-label="Toggle drag-to-reorder"
                    aria-pressed="false"
                >
                    <span class="btn-text">Drag</span>
                </button>

                <button 
                    class="btn-icon" 
                    id="themeToggle" 
                    title="Toggle dark mode"
                    aria-label="Toggle dark mode"
                    aria-pressed="false"
                >
                    <span class="btn-text">Theme</span>
                </button>

                <!-- animation toggle removed -->

                <a class="btn-icon" href="/analytics.html" title="Analytics" aria-label="Open analytics">
                    <span class="btn-text">Analytics</span>
                </a>

                <span class="auth-pair">
                    <button class="btn-icon" id="signInBtn" title="Sign in" aria-label="Sign in">
                        <span class="btn-text">Sign In</span>
                    </button>

                    <button class="btn-secondary" id="registerBtn" title="Register" aria-label="Register">
                        Register
                    </button>
                </span>
                
                <button 
                    class="btn-primary" 
                    id="addTaskBtn"
                    aria-label="Add new task"
                >
                    <span class="btn-icon-inner">+</span>
                    <span class="btn-text">Add Task</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" role="complementary" aria-hidden="false">
            <div class="sidebar-header">
                <!-- heading intentionally removed to reduce repetition -->
                <div class="sidebar-controls">
                    <label class="sort-label" for="sortSelect">Sort:</label>
                    <select id="sortSelect" class="sort-select" aria-label="Sort tasks">
                        <option value="dueDate">Due Date</option>
                        <option value="priority">Priority</option>
                        <option value="created">Newest</option>
                        <option value="category">Category</option>
                    </select>
                </div>
            </div>
            
                <div class="filter-section">
                <div class="filter-group">
                    <label class="filter-item">
                        <input 
                            type="radio" 
                            name="status" 
                            value="all" 
                            checked
                            aria-label="Show all tasks"
                        >
                        <span class="filter-label">All Tasks</span>
                        <span class="filter-count" data-status="all">0</span>
                    </label>
                </div>
                
                <div class="filter-divider"></div>
                
                <div class="filter-group">
                    <label class="filter-item">
                        <input 
                            type="radio" 
                            name="status" 
                            value="active"
                            aria-label="Show active tasks"
                        >
                        <span class="filter-label">Active</span>
                        <span class="filter-count" data-status="active">0</span>
                    </label>
                    
                    <label class="filter-item">
                        <input 
                            type="radio" 
                            name="status" 
                            value="completed"
                            aria-label="Show completed tasks"
                        >
                        <span class="filter-label">Completed</span>
                        <span class="filter-count" data-status="completed">0</span>
                    </label>
                    
                    <label class="filter-item">
                        <input 
                            type="radio" 
                            name="status" 
                            value="overdue"
                            aria-label="Show overdue tasks"
                        >
                        <span class="filter-label">Overdue</span>
                        <span class="filter-count" data-status="overdue">0</span>
                    </label>
                </div>
                
                <div class="filter-divider"></div>
                
                <div class="filter-group" id="categoryFilters">
                    <!-- Category filters dynamically inserted -->
                </div>
            </div>
            
            <div class="sidebar-footer">
                <div class="stats-widget">
                    <div class="stat-item">
                        <span class="stat-label">Completion</span>
                        <span class="stat-value" id="completionRate">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content" role="main">
            <!-- Tasks Section -->
            <section class="tasks-section">
                <div class="section-header">
                    <h2 class="section-title" id="sectionTitle">All Tasks</h2>
                    <div class="view-controls">
                        <button 
                            class="view-btn active" 
                            data-view="list"
                            title="List view"
                            aria-label="Switch to list view"
                        >
                            ‚â°
                        </button>
                        <button 
                            class="view-btn" 
                            data-view="grid"
                            title="Grid view"
                            aria-label="Switch to grid view"
                        >
                            ‚äû
                        </button>
                    </div>
                </div>
                
                <div class="tasks-container" id="tasksContainer" data-view="list">
                    <!-- Tasks dynamically inserted -->
                </div>
                
                <div class="empty-state" id="emptyState" style="display: none;">
                    <div class="empty-icon">üìù</div>
                    <h3>No tasks yet</h3>
                    <p>Create your first task to get started</p>
                </div>
            </section>

            <!-- Analytics moved to a standalone page (analytics.html) -->
            <!-- Use the top navigation or open analytics.html to view analytics dashboard -->
        </main>
    </div>

    <div class="sidebar-overlay" id="sidebarOverlay" aria-hidden="true"></div>

    <!-- Modal: Add/Edit Task -->
    <div class="modal" id="taskModal" role="dialog" aria-labelledby="taskModalTitle" aria-hidden="true">
        <div class="modal-overlay"></div>
        <div class="modal-content glassmorphic">
            <div class="modal-header">
                <h2 id="taskModalTitle">Add New Task</h2>
                <button class="btn-close" aria-label="Close modal">√ó</button>
            </div>
            
            <form class="task-form" id="taskForm">
                <div class="form-group">
                    <label for="taskTitle">Task Title *</label>
                    <input 
                        type="text" 
                        id="taskTitle" 
                        class="form-input" 
                        placeholder="Enter task title"
                        required
                        aria-required="true"
                    >
                    <span class="form-error" id="titleError"></span>
                </div>
                
                <div class="form-group">
                    <label for="taskDescription">Description</label>
                    <textarea 
                        id="taskDescription" 
                        class="form-input" 
                        placeholder="Enter task description (optional)"
                        rows="3"
                    ></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="taskCategory">Category *</label>
                        <select id="taskCategory" class="form-input" required aria-required="true">
                            <option value="">Select a category</option>
                            <option value="work">Work</option>
                            <option value="personal">Personal</option>
                            <option value="health">Health</option>
                            <option value="shopping">Shopping</option>
                            <option value="finance">Finance</option>
                            <option value="learning">Learning</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskPriority">Priority</label>
                        <select id="taskPriority" class="form-input">
                            <option value="low">Low</option>
                            <option value="medium" selected>Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="taskDueDate">Due Date</label>
                        <input 
                            type="date" 
                            id="taskDueDate" 
                            class="form-input"
                        >
                    </div>
                    
                    <div class="form-group">
                        <label for="taskTags">Tags</label>
                        <input 
                            type="text" 
                            id="taskTags" 
                            class="form-input" 
                            placeholder="Enter tags separated by commas"
                        >
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="taskRecurring">
                        <span>Make this task recurring</span>
                    </label>
                </div>
                
                <div class="recurrence-section" id="recurrenceSection" style="display: none;">
                    <h3>Recurrence Pattern</h3>
                    
                    <div class="form-group">
                        <label for="recurrenceType">Pattern Type</label>
                        <select id="recurrenceType" class="form-input">
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="customDaysGroup" style="display: none;">
                        <label>Select Days</label>
                        <div class="days-selector">
                            <label class="day-checkbox">
                                <input type="checkbox" name="customDays" value="0"> Sun
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="customDays" value="1"> Mon
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="customDays" value="2"> Tue
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="customDays" value="3"> Wed
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="customDays" value="4"> Thu
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="customDays" value="5"> Fri
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="customDays" value="6"> Sat
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="recurrenceEndDate">Recurrence End Date</label>
                        <input 
                            type="date" 
                            id="recurrenceEndDate" 
                            class="form-input"
                        >
                    </div>
                    
                    <div class="recurrence-preview" id="recurrencePreview"></div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Save Task</button>
                    <button type="button" class="btn-secondary" id="cancelBtn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notification Toast -->
    <div class="notification" id="notification" role="alert" aria-live="polite">
        <span id="notificationMessage"></span>
    </div>

    <!-- Auth Modal -->
    <div class="modal" id="authModal" role="dialog" aria-labelledby="authModalTitle" aria-hidden="true">
        <div class="modal-overlay"></div>
        <div class="modal-content glassmorphic" id="authContent">
            <div class="modal-header">
                <h2 id="authModalTitle">Sign In</h2>
                <button class="btn-close" id="authClose" aria-label="Close">√ó</button>
            </div>

            <form id="authForm" class="auth-form">
                <input type="hidden" id="authMode" value="signin">

                <div class="form-group" id="authNameGroup" style="display:none;">
                    <label for="authName">Full name</label>
                    <input id="authName" class="form-input" type="text" placeholder="Your name">
                </div>

                <div class="form-group">
                    <label for="authEmail">Email</label>
                    <input id="authEmail" class="form-input" type="email" placeholder="you@example.com" required>
                </div>

                <div class="form-group">
                    <label for="authPassword">Password</label>
                    <input id="authPassword" class="form-input" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn-primary" id="authSubmit">Sign In</button>
                    <button type="button" class="btn-secondary" id="authSwitch">Switch to Register</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- Footer -->
    <footer class="app-footer">
        <p>&copy; 2025 Mahmoud Ashraf. All rights reserved.</p>
    </footer>

    <!-- JavaScript Modules (ordered for dependencies) -->
    <script src="js/modules/state.js"></script>
    <script src="js/modules/storage.js"></script>
    <script src="js/modules/recurrence.js"></script>
    <script src="js/modules/charts.js"></script>
    <script src="js/modules/ui.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
